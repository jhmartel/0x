<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Fermat Weber Points and L1 Problems with No Formulas.</h1><p class="page-description">We record some very simple comments on the difficulties of computing Fermat Weber points of probability measures. These are points x which minimize the average euclidean distance from the points supporting a probability measure mu on Rn. The problem is that mathematicians need to stop asking for formulas for naive geometric questions. Besides formulas are not as useful as they might initially appear. Instead fast approximation and convergence are much more useful, although the resultant is not known a priori.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-10-18T00:00:00-05:00" itemprop="datePublished">
        Oct 18, 2022
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">JHM</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      3 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/fp/categories/#fastpages">fastpages</a>
        &nbsp;
      
        <a class="category-tags-link" href="/fp/categories/#jupyter">jupyter</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/jhmartel/fp/tree/master/_notebooks/2022-10-18-FermatWeberPointsNoFormula.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/fp/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/jhmartel/fp/master?filepath=_notebooks%2F2022-10-18-FermatWeberPointsNoFormula.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/fp/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/jhmartel/fp/blob/master/_notebooks/2022-10-18-FermatWeberPointsNoFormula.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/fp/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Fjhmartel%2Ffp%2Fblob%2Fmaster%2F_notebooks%2F2022-10-18-FermatWeberPointsNoFormula.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/fp/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-10-18-FermatWeberPointsNoFormula.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://colab.research.google.com/github/jhmartel/fp/blob/master/_notebooks/2022-10-18-FermatWeberPointsNoFormula.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" /></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Fermat-Weber-Points-of-Probability-Measures-&#956;"><em>Fermat-Weber Points of Probability Measures &#956;</em><a class="anchor-link" href="#Fermat-Weber-Points-of-Probability-Measures-&#956;"> </a></h1><p>We've been reviewing a Mathoverflow post <a href="https://mathoverflow.net/questions/432157/how-to-find-the-point-at-minimal-average-distance-of-a-given-measure?noredirect=1#comment1112416_432157">here</a> about finding <em>formulas</em> for the Fermat-Weber points of a probability measure $\mu$ on ${\bf{R}}^n$. The FW point is that point $\bar{x}$ which minimizes the average $L^1$ distance to the measure, i.e. $FW$ is the minimizing argument of $$\min_x f_\mu(x)=\min_{x} \int ||x-y|| ~d\mu(y),$$ where $x$ ranges over ${\bf{R}}^n$. It's remarkable that this problem admits <em>no good</em> formula. The problem is that $f_\mu(x)$ defined above is not everywhere differentiable on the domain, specifically being not differentiable along the support of $\mu$.</p>
<p>Now the minimizing program is readily computed approximately, i.e. numerically. This means we can basically start with any initial point $x_0$ and find a type of <em>gradient flow</em> to find sequence $x_1$, $x_2$, $\ldots$ which <em>converges</em> to a minimizer $\lim_{k\to +\infty}x_k= x_\infty$. In practice, this is good enough.</p>
<p>But what about the <em>formula</em>? This is typical of naive mathematicians, to always seek out a "formula". But formulas are the exception. There's probably an easy argument that numbers given by "formula" are exceedingly rare, i.e. measure zero on the real number line ${\bf{R}}$. For example, consider the problem frequently arising in probability: if $y=F(x):=Prob(X \leq x)=\int_{\infty}^x f(z)dz$ is the cumulative distribution function which is monotonically increasing, then it's known that the inverse $x=F^{-1}(y)$ exists, but does not typically admit a formula.</p>
<p>Let's consider the Legendre-Fenchel transform ${f_\mu}^*(n)$
of the function $f_\mu(x):=\int ||x-y|| d\mu(y)$. Is a formula for $f^*_\mu$ available? Here we must acknowledge the unfortunate fact that Legendre transforms of convex combinations are not immediately computable. That is, we find only the general inequality $$(\frac{1}{2}f_0 + \frac{1}{2}f_1)^* \leq \frac{1}{2}f_0^* + \frac{1}{2} f_1^*.$$</p>
<p>This implies ${f^*_\mu}(n)$ satisfies the pointwise inequality $${f^*_\mu}(n)\leq \nu(n)$$ where $\nu$ is the "naive" convex recombination $$\nu(n):=\int \langle n, y\rangle ~d\mu(y)$$ if $||n||\leq 1$, and $$\nu(n)=+\infty$$ otherwise. Notice that the naive transform $\nu$ is basically a linear function on it's domain, namely $\langle n, \bar{y} \rangle$ where $\bar{y} :=\int y ~d\mu(y)$. It would be convenient to have a general rule or formula for $f^*_\mu$, but this is not achievable at this stage.</p>
<p>It proves again that the naive $L^1$ cost $c=d^1$ might seem convenient, but it's really not due to its nondifferentiability along the diagonal. For example, this implies that $f_\mu$ is <em>not</em> differentiable along the support of $\mu$. It's clear that $f_\mu$ is <em>finite</em> and <em>continuous</em> along $spt(\mu)$, however the gradient formula $$\nabla_x f_\mu(x) = \int \frac{x-y}{|x-y|} d\mu(y), $$ and find the integrand undefined whenever $x=y$ for some $y\in spt(\mu)$. Notice the integral defining $\nabla_x f_\mu$ is a sum of unit vectors.</p>
<p>Here arises a question from first year calculus. What are the critical points of $f_\mu$? Strictly speaking, the critical points consist of those points $\bar{x}$ where $\nabla_x f_\mu(\bar{x})=0$ <em>and</em> those points where the function $f_\mu$ is <em>not</em> differentiable. Therefore we find $$Crit(f_\mu) = \{\bar{x}~|~\nabla f_\mu(\bar{x})=0\} \cup spt(\mu).$$</p>
<p>This makes the discovery of the minimizer rather difficult, because we also need to compare the critical value at $\bar{x}$ with the values of $f_\mu$ restricted to $spt(\mu)$. But this restriction $f_\mu|_{spt(\mu)}$ is <em>not</em> differentiable, so there are no critical points to speak of, i.e. every point $x\in spt(\mu)$ is a critical point according to the strict definition! And here is the basic difficulty in using $L^1$ distances, and the inability to identify the minimizer.</p>
<p>The question arises: <em>"Is the restriction of</em> ${f_\mu}$ <em>to the support</em> $spt(\mu)$ <em>really nondifferentiable?"</em></p>
<p>Here the properties of $spt(\mu)$ as a subset of ${\bf{R}}^n$ has to play a role in deciding the behaviour of $f_\mu$ when restricted to the support $spt(\mu)$. But this is a question for another time...</p>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="jhmartel/fp"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/fp/fastpages/jupyter/2022/10/18/FermatWeberPointsNoFormula.html" hidden></a>
</article>
