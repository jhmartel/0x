<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Fermat Weber Points and L1 Problems with No Formulas. | JHM Lab.</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Fermat Weber Points and L1 Problems with No Formulas." />
<meta name="author" content="JHM" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="We record some very simple comments on the difficulties of computing Fermat Weber points of probability measures. These are points x which minimize the average euclidean distance from the points supporting a probability measure mu on Rn. The problem is that mathematicians need to stop asking for formulas for naive geometric questions. Besides formulas are not as useful as they might initially appear. Instead fast approximation and convergence are much more useful, although the resultant is not known a priori." />
<meta property="og:description" content="We record some very simple comments on the difficulties of computing Fermat Weber points of probability measures. These are points x which minimize the average euclidean distance from the points supporting a probability measure mu on Rn. The problem is that mathematicians need to stop asking for formulas for naive geometric questions. Besides formulas are not as useful as they might initially appear. Instead fast approximation and convergence are much more useful, although the resultant is not known a priori." />
<link rel="canonical" href="https://jhmartel.github.io/fp/fastpages/jupyter/2022/10/18/FermatWeberPointsNoFormula.html" />
<meta property="og:url" content="https://jhmartel.github.io/fp/fastpages/jupyter/2022/10/18/FermatWeberPointsNoFormula.html" />
<meta property="og:site_name" content="JHM Lab." />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-10-18T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Fermat Weber Points and L1 Problems with No Formulas." />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"JHM"},"dateModified":"2022-10-18T00:00:00-05:00","datePublished":"2022-10-18T00:00:00-05:00","description":"We record some very simple comments on the difficulties of computing Fermat Weber points of probability measures. These are points x which minimize the average euclidean distance from the points supporting a probability measure mu on Rn. The problem is that mathematicians need to stop asking for formulas for naive geometric questions. Besides formulas are not as useful as they might initially appear. Instead fast approximation and convergence are much more useful, although the resultant is not known a priori.","headline":"Fermat Weber Points and L1 Problems with No Formulas.","mainEntityOfPage":{"@type":"WebPage","@id":"https://jhmartel.github.io/fp/fastpages/jupyter/2022/10/18/FermatWeberPointsNoFormula.html"},"url":"https://jhmartel.github.io/fp/fastpages/jupyter/2022/10/18/FermatWeberPointsNoFormula.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/fp/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://jhmartel.github.io/fp/feed.xml" title="JHM Lab." /><link rel="shortcut icon" type="image/x-icon" href="/fp/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/fp/">JHM Lab.</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/fp/about/">About Me</a><a class="page-link" href="/fp/search/">Search</a><a class="page-link" href="/fp/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Fermat Weber Points and L1 Problems with No Formulas.</h1><p class="page-description">We record some very simple comments on the difficulties of computing Fermat Weber points of probability measures. These are points x which minimize the average euclidean distance from the points supporting a probability measure mu on Rn. The problem is that mathematicians need to stop asking for formulas for naive geometric questions. Besides formulas are not as useful as they might initially appear. Instead fast approximation and convergence are much more useful, although the resultant is not known a priori.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-10-18T00:00:00-05:00" itemprop="datePublished">
        Oct 18, 2022
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">JHM</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      3 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/fp/categories/#fastpages">fastpages</a>
        &nbsp;
      
        <a class="category-tags-link" href="/fp/categories/#jupyter">jupyter</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/jhmartel/fp/tree/master/_notebooks/2022-10-18-FermatWeberPointsNoFormula.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/fp/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/jhmartel/fp/master?filepath=_notebooks%2F2022-10-18-FermatWeberPointsNoFormula.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/fp/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/jhmartel/fp/blob/master/_notebooks/2022-10-18-FermatWeberPointsNoFormula.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/fp/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Fjhmartel%2Ffp%2Fblob%2Fmaster%2F_notebooks%2F2022-10-18-FermatWeberPointsNoFormula.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/fp/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-10-18-FermatWeberPointsNoFormula.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://colab.research.google.com/github/jhmartel/fp/blob/master/_notebooks/2022-10-18-FermatWeberPointsNoFormula.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" /></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Fermat-Weber-Points-of-Probability-Measures-&#956;"><em>Fermat-Weber Points of Probability Measures &#956;</em><a class="anchor-link" href="#Fermat-Weber-Points-of-Probability-Measures-&#956;"> </a></h1><p>We've been reviewing a Mathoverflow post <a href="https://mathoverflow.net/questions/432157/how-to-find-the-point-at-minimal-average-distance-of-a-given-measure?noredirect=1#comment1112416_432157">here</a> about finding <em>formulas</em> for the Fermat-Weber points of a probability measure $\mu$ on ${\bf{R}}^n$. The FW point is that point $\bar{x}$ which minimizes the average $L^1$ distance to the measure, i.e. $FW$ is the minimizing argument of $$\min_x f_\mu(x)=\min_{x} \int ||x-y|| ~d\mu(y),$$ where $x$ ranges over ${\bf{R}}^n$. It's remarkable that this problem admits <em>no good</em> formula. The problem is that $f_\mu(x)$ defined above is not everywhere differentiable on the domain, specifically being not differentiable along the support of $\mu$.</p>
<p>Now the minimizing program is readily computed approximately, i.e. numerically. This means we can basically start with any initial point $x_0$ and find a type of <em>gradient flow</em> to find sequence $x_1$, $x_2$, $\ldots$ which <em>converges</em> to a minimizer $\lim_{k\to +\infty}x_k= x_\infty$. In practice, this is good enough.</p>
<p>But what about the <em>formula</em>? This is typical of naive mathematicians, to always seek out a "formula". But formulas are the exception. There's probably an easy argument that numbers given by "formula" are exceedingly rare, i.e. measure zero on the real number line ${\bf{R}}$.</p>
<p>Let's consider the Legendre-Fenchel transform ${f_\mu}^*(n)$
of the function $f_\mu(x):=\int ||x-y|| d\mu(y)$. Is a formula for $f^*_\mu$ available? Here we must acknowledge the unfortunate fact that Legendre transforms of convex combinations are not immediately computable. That is, we have $$(\frac{1}{2}f_0 + \frac{1}{2}f_1)^* \leq \frac{1}{2}f_0^* + \frac{1}{2} f_1^*.$$</p>
<p>This implies ${f^*_\mu}(n)$ is less than or equal to the naive recombination $$\nu(n):=\int \langle n, y\rangle ~d\mu(y)$$ if $||n||\leq 1$, and $$\nu(n)=+\infty$$ otherwise. Notice that the naive transform $\nu$ is basically a linear function on it's domain, namely $\langle n, \bar{y} \rangle$ where $\bar{y} :=\int y ~d\mu(y)$. It would be convenient to have a general rule or formula for $f^*_\mu$, but this is not achievable at this stage.</p>
<p>It proves again that the naive $L^1$ cost $c=d^1$ might seem convenient, but it's really not due to its nondifferentiability along the diagonal. For example, this implies that $f_\mu$ is <em>not</em> differentiable along the support of $\mu$. It's clear that $f_\mu$ is <em>finite</em> and <em>continuous</em> along $spt(\mu)$, however the gradient formula $$\nabla_x f_\mu(x) = \int \frac{x-y}{|x-y|} d\mu(y), $$ and find the integrand undefined whenever $x=y$ for some $y\in spt(\mu)$. Notice the integral defining $\nabla_x f_\mu$ is a sum of unit vectors.</p>
<p>Here arises a question from first year calculus. What are the critical points of $f_\mu$? Strictly speaking, the critical points consist of those points $\bar{x}$ where $\nabla_x f_\mu(\bar{x})=0$ <em>and</em> those points where the function $f_\mu$ is <em>not</em> differentiable. Therefore we find $$Crit(f_\mu) = \{\bar{x}~|~\nabla f_\mu(\bar{x})=0\} \cup spt(\mu).$$</p>
<p>This makes the discovery of the minimizer rather difficult, because we also need to compare the critical value at $\bar{x}$ with the values of $f_\mu$ restricted to $spt(\mu)$. But this restriction $f_\mu|_{spt(\mu)}$ is <em>not</em> differentiable, so there are no critical points to speak of, i.e. every point $x\in spt(\mu)$ is a critical point according to the strict definition! And here is the basic difficulty in using $L^1$ distances, and the inability to identify the minimizer.</p>
<p>The question arises: <em>"Is the restriction $f</em>\mu|<em>{spt(\mu)}$ really nondifferentiable?"</em></p>
<p>Here the properties of $spt(\mu)$ as a subset of ${\bf{R}}^n$ has to play a role in deciding the behaviour of $f_\mu$ when restricted to the support $spt(\mu)$. But this is a question for another time...</p>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="jhmartel/fp"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/fp/fastpages/jupyter/2022/10/18/FermatWeberPointsNoFormula.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/fp/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/fp/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/fp/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Optimal Transport, Topology of Singularities, Physics.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>
