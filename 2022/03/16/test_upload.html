<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Ampere’s Force Law | JHM Lab.</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Ampere’s Force Law" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Optimal Transport, Topology of Singularities, Physics." />
<meta property="og:description" content="Optimal Transport, Topology of Singularities, Physics." />
<link rel="canonical" href="https://jhmartel.github.io/fp/2022/03/16/test_upload.html" />
<meta property="og:url" content="https://jhmartel.github.io/fp/2022/03/16/test_upload.html" />
<meta property="og:site_name" content="JHM Lab." />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-03-16T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Ampere’s Force Law" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-03-16T00:00:00-05:00","datePublished":"2022-03-16T00:00:00-05:00","description":"Optimal Transport, Topology of Singularities, Physics.","headline":"Ampere’s Force Law","mainEntityOfPage":{"@type":"WebPage","@id":"https://jhmartel.github.io/fp/2022/03/16/test_upload.html"},"url":"https://jhmartel.github.io/fp/2022/03/16/test_upload.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/fp/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://jhmartel.github.io/fp/feed.xml" title="JHM Lab." /><link rel="shortcut icon" type="image/x-icon" href="/fp/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/fp/">JHM Lab.</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/fp/about/">About Me</a><a class="page-link" href="/fp/search/">Search</a><a class="page-link" href="/fp/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Ampere&#39;s Force Law</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-03-16T00:00:00-05:00" itemprop="datePublished">
        Mar 16, 2022
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      7 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/jhmartel/fp/tree/master/_notebooks/2022-03-16-test_upload.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/fp/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/jhmartel/fp/master?filepath=_notebooks%2F2022-03-16-test_upload.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/fp/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/jhmartel/fp/blob/master/_notebooks/2022-03-16-test_upload.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/fp/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Fjhmartel%2Ffp%2Fblob%2Fmaster%2F_notebooks%2F2022-03-16-test_upload.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/fp/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-03-16-test_upload.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://colab.research.google.com/github/jhmartel/fp/blob/master/_notebooks/2022-03-16-test_upload.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" /></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Test
"Test. "</p>
<p>toc: false
branch: master
badges: false
comments: true
author: JHM
categories: [einstein, maxwell, wave equation, lorentz, SR]</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This article is an extension of Don Scott's work [ref] on modelling Birkeland currents. This is low-beta plasma delivering electric current along filaments in space. [ref]. Scott's model relies on the Maxwell equations and Lorentz force law. But these equations are undergoing a renewed criticism, and Weber's electrodynamics is being reconsidered as an alternative. Our objective in this article is to derive the equations of Birkeland currents based on Weber's electrodynamics.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">dot</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">):</span>
    <span class="n">vx1</span><span class="p">,</span> <span class="n">vy1</span><span class="p">,</span> <span class="n">vz1</span> <span class="o">=</span> <span class="n">v1</span>
    <span class="n">vx2</span><span class="p">,</span> <span class="n">vy2</span><span class="p">,</span> <span class="n">vz2</span> <span class="o">=</span> <span class="n">v2</span>
    <span class="k">return</span> <span class="n">vx1</span><span class="o">*</span><span class="n">vx2</span><span class="o">+</span><span class="n">vy1</span><span class="o">*</span><span class="n">vy2</span><span class="o">+</span><span class="n">vz1</span><span class="o">*</span><span class="n">vz2</span>

<span class="k">def</span> <span class="nf">scalar</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">v1</span><span class="p">):</span>
    <span class="n">vx1</span><span class="p">,</span> <span class="n">vy1</span><span class="p">,</span> <span class="n">vz1</span> <span class="o">=</span> <span class="n">v1</span> 
    <span class="k">return</span> <span class="p">[</span><span class="n">a</span><span class="o">*</span><span class="n">vx1</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">vy1</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">vz1</span><span class="p">]</span>

<span class="c1">## Ampere&#39;s Force </span>
<span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="n">state1</span><span class="p">,</span> <span class="n">state2</span><span class="p">):</span>
    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">vx1</span><span class="p">,</span> <span class="n">vy1</span><span class="p">,</span> <span class="n">vz1</span> <span class="o">=</span> <span class="n">state1</span>
    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z2</span><span class="p">,</span> <span class="n">vx2</span><span class="p">,</span> <span class="n">vy2</span><span class="p">,</span> <span class="n">vz2</span> <span class="o">=</span> <span class="n">state2</span>
    <span class="n">v1</span><span class="o">=</span><span class="p">[</span><span class="n">vx1</span><span class="p">,</span><span class="n">vy1</span><span class="p">,</span><span class="n">vz1</span><span class="p">]</span>
    <span class="n">v2</span><span class="o">=</span><span class="p">[</span><span class="n">vx2</span><span class="p">,</span><span class="n">vy2</span><span class="p">,</span><span class="n">vz2</span><span class="p">]</span>

    <span class="n">I1</span><span class="o">=</span><span class="n">dot</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v1</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
    <span class="n">I2</span><span class="o">=</span><span class="n">dot</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span><span class="n">v2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>

    <span class="n">rho_12</span> <span class="o">=</span> <span class="p">((</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">z2</span><span class="o">-</span><span class="n">z1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
    <span class="n">rhat12</span> <span class="o">=</span> <span class="n">scalar</span><span class="p">(</span><span class="n">rho_12</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">x1</span><span class="o">-</span><span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="o">-</span><span class="n">y2</span><span class="p">,</span> <span class="n">z1</span><span class="o">-</span><span class="n">z2</span><span class="p">])</span>

    <span class="n">coefficient</span> <span class="o">=</span> <span class="o">-</span><span class="n">I1</span><span class="o">*</span><span class="n">I2</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">dot</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">dot</span><span class="p">(</span><span class="n">rhat12</span><span class="p">,</span> <span class="n">v1</span><span class="p">)</span><span class="o">*</span><span class="n">dot</span><span class="p">(</span><span class="n">rhat12</span><span class="p">,</span> <span class="n">v2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">rho_12</span><span class="p">)</span><span class="o">**-</span><span class="mi">1</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">z1</span><span class="p">]</span><span class="o">+</span><span class="n">scalar</span><span class="p">(</span><span class="n">coefficient</span><span class="p">,</span> <span class="n">rhat12</span><span class="p">)</span>


<span class="n">s0</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span><span class="o">.</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">s1</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.9</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>    

<span class="n">F</span><span class="p">(</span><span class="n">s0</span><span class="p">,</span><span class="n">s1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[0, 0, 0, -0.05727564927611038, 0.0, 0.0]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ampere's force law has several predictions.</p>
<ul>
<li>Parallel colinear current elements repel</li>
<li>Reversing a parallel colinear current attracts by 2/3rd of the repelling force.</li>
<li>Parallel adjacent current elements attract</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">s0</span><span class="o">=</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span> <span class="p">]</span>
<span class="n">s1</span><span class="o">=</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span> <span class="p">]</span>
<span class="n">s3</span><span class="o">=</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span> <span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">s0</span><span class="p">,</span><span class="n">s1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="n">s0</span><span class="p">))</span>


<span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">s0</span><span class="p">,</span><span class="n">s3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">s3</span><span class="p">,</span><span class="n">s0</span><span class="p">))</span>

<span class="c1"># Parallel Adjacent Current Elements Attract</span>
<span class="n">s2</span><span class="o">=</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">s0</span><span class="p">,</span> <span class="n">s2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[0, 0, 0, 0.0, 0.0, -0.5]
[0, 0, 2, 0.0, 0.0, 0.5]
[0, 0, 0, -0.0, -0.0, 0.3333333333333333]
[0, 0, 3, -0.0, -0.0, -0.3333333333333333]
[0, 0, 0, 2.0, -0.0, -0.0]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We want to move towards the Birkeland currents, which is a cylindrical plasma. Following Scott's approach, we look for an integral equation in the cylindrical coordinates $\rho$, $\theta$, $z$.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Converts Cartesian states to Cylindrical States.</span>
<span class="k">def</span> <span class="nf">C</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">vx</span><span class="p">,</span><span class="n">vy</span><span class="p">,</span><span class="n">vz</span> <span class="o">=</span> <span class="n">state</span>
    
    <span class="n">rho</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
    <span class="n">theta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">y</span><span class="o">/</span><span class="n">x</span><span class="p">)</span>
    
    <span class="n">vr</span> <span class="o">=</span> <span class="p">(</span><span class="n">vx</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">vy</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="n">rho</span>
    <span class="n">vt</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">vx</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="n">vy</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">rho</span><span class="o">**-</span><span class="mi">2</span><span class="p">)</span>

    
    <span class="k">return</span> <span class="p">[</span> <span class="n">rho</span><span class="p">,</span><span class="n">theta</span><span class="p">,</span><span class="n">z</span><span class="p">,</span> <span class="n">vr</span><span class="p">,</span><span class="n">vt</span><span class="p">,</span><span class="n">vz</span> <span class="p">]</span>

<span class="c1"># Converts Cylindrical State to Cartesian state</span>
<span class="k">def</span> <span class="nf">D</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
    <span class="n">rho</span><span class="p">,</span><span class="n">theta</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">vr</span><span class="p">,</span><span class="n">vt</span><span class="p">,</span><span class="n">vz</span> <span class="o">=</span> <span class="n">state</span>

    <span class="n">x</span><span class="o">=</span><span class="n">rho</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
    <span class="n">y</span><span class="o">=</span><span class="n">rho</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>

    <span class="n">vx</span><span class="o">=</span><span class="n">vr</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span><span class="o">-</span><span class="n">vt</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span><span class="o">*</span><span class="n">rho</span>
    <span class="n">vy</span><span class="o">=</span><span class="n">vr</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span><span class="o">+</span><span class="n">vt</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span><span class="o">*</span><span class="n">rho</span>

    <span class="k">return</span> <span class="p">[</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span> <span class="n">vx</span><span class="p">,</span><span class="n">vy</span><span class="p">,</span><span class="n">vz</span> <span class="p">]</span>
    

<span class="c1">#print(C([ 1,1,0, 0,0.5,1.2]))</span>
<span class="c1">#print(D(C([ 1,1,0, 0,0.5,1.2])))</span>

<span class="c1">## Ampere&#39;s Force in Cylindrical Coordinates rho, theta, z:</span>

<span class="k">def</span> <span class="nf">AFC</span><span class="p">(</span><span class="n">state1</span><span class="p">,</span> <span class="n">state2</span><span class="p">):</span>
    <span class="n">rho1</span><span class="p">,</span> <span class="n">theta1</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">vr1</span><span class="p">,</span> <span class="n">vt1</span><span class="p">,</span> <span class="n">vz1</span> <span class="o">=</span> <span class="n">state1</span> 
    <span class="k">return</span> <span class="n">C</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="n">state2</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="n">state1</span><span class="p">)))</span>

<span class="c1"># output of above force is cartesian valued. </span>
<span class="c1"># We need to translate the vector back to the state which is centred on state1 position.</span>
<span class="n">c0</span><span class="o">=</span><span class="p">[</span> <span class="mf">1.1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mi">1</span> <span class="p">]</span>  <span class="c1">## [ rho, theta, z, vr, vt, vz ]</span>
<span class="n">c1</span><span class="o">=</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span> <span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">AFC</span><span class="p">(</span><span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>

<span class="c1">## Need use sympy to obtain some formulas(!) for the force law, and obtain the integral equation for the equilibrium condition.</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[1.0, 0.0, 0, 33.120386471175095, -0.0, -0.0]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the previous cell we have a function AFC which computes Amperes force in cylindrical coordinates. But this does not help us symbolically identify the balance equation [ref] in cylindrical coordinates.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If $C_2$ is a closed current with line element $ds_2$, then the force of the current on the line element is $$F_{C_2 ~~\text{on}~~I_1 ds_1} =  I_1 ds_1 \times ( \oint_{C_2} I_2 ds_2 \times \nabla_1(\frac{1}{r_{12}})).$$</p>
<p>N.B. Ampere's force between current elements is radial. However the force exerted by a closed current $C$ on a current element $I_1 ds_1$  is always orthogonal to the current element, as is clear from the above equation. This was announced by Ampere in 1820s [ref]. Historically one finds that Ampere's force law differs from Grassmann's proposed force law by an exact differential, hence the integrals over closed curves coincide. [ref: Assis]. Grassmann's force law was the more formulaic  $$F^G_{21}:=I_1 d\ell_1 \times (I_2 d\ell_2 \times \nabla_1(\frac{1}{r_{12}})) . $$ However this law does <em>not</em> satisfy action-reaction principle, except between closed currents. In general for current elements we have $F_{21} \neq F_{12} = 0$.</p>
<p>When the currents are filamentary, then Ampere's law yields a virtual magnetic field $B$ defined by $$B=\oint_{C_2} I_2 d\ell_2 \times \nabla_1(\frac{1}{r}) .$$ However we can replace $I_2 d\ell_2$ with $J dVol_2$, where $Vol_2$ represents a volume form defined relative to the index $2$ variable. Then we have the following expression from [Assis, Ch.4]: $$B(r_1,t)=\iiint d^3(r_2)~ J(r_2,t) \times \nabla_1 (\frac{1}{r_{12}}).$$</p>
<p>In the context of Birkeland currents, we have a three-dimensional cylinder which is assumed to contain plasma [no collisional low beta] and carrying an electric current between it's two ends. The magnetic field $B$ in this setting induced by the charge distribution $J=J(x)$ is computed by Ampere's force as a volume integral over the tube.</p>
<p>
$$B(x)=\int_{Tube} d^3(y) ~~ \bf{F}_{J(y) ~ \text{on}~J(x)}$$
</p>
<p>Remark. In basic electromagnetism theory after Maxwell, it's important to observe that the Maxwell magnetic field $B(x)$ can be nonzero at points where $J(x)=0$. I.e., it is supposed that $B$ can be nonzero at points in vacuum where there is no charge present. But of course, $B$ properly defined depends on a choice of <em>test</em> charge, i.e. $B$ represents an amount of force that would be exerted on the test charge <em>if</em> that charge was located at $x$. But of course then $B(x)$ represents not a vacuum at $x$ but implicitly involves a test current element to exist at $x$. This is perhaps overly philosophical remark.</p>
<p>Is it possible that $B(x)$ is nonzero at a point where $J(x)=0$ ?  No, because we cannot compute $B(x)$ at a point where $J(x)=0$ except to compute $B=0$. This is because we are expressly considering the interaction of $J(x)$ with $J(y)$ at a different point. We assume there is a radial action-at-a-distance between the charges. Therefore the equilibrium condition for the field $J$ in the Birkeland current is $$\int dy ~~ \bf{F}_{J(y)~\text{on}~ J(x)}=0$$ for every $x$. The above integral represents a Bochner vector-valued integral. It therefore represents three equations in the $x,y,z$ rectilinear coordinates.</p>
<p>Following Don Scott, we can express these three equations using cyclindrical coordinates, and making some general assumptions about the variation of $B$ and $J$ with respect to time $t$ and the cylindrical coordinates $\rho, \theta, z$.</p>
<p>However, how do we guarantee that current is being delivered, i.e. that the Birkeland current <em>is</em> delivering power?</p>
<p>To compute the internal pressures of the charge distribution $J$ requires a method for determining the interaction of $J$ and $B$. Now Lorentz force law would imply that $B$ acts on $J$ by the cross-product $B\times J$. However we prefer to follow the Ampere-Weber electrodynamics. In this case we have <em>no</em> law for the interaction of $B$ and $J$. What is required is a different integration, namely $$\iiint dy~~~ \bf{F}</p>
<p>computing $\bf{F}_{B(x)~ \text{on}~ J(x)}.$</p>
<p>The magnetic fields $B$ then became the integral of forces between currents. As Assis has proved in [ref] Ampere's formula establishes a computational basis for the non-existence of magnetic monopoles. In otherwords we find that $$\nabla \cdot B = \nabla \cdot (\nabla \times [potential])=0$$ since the divergence of a curl vanishes identically, i.e. $d\circ d=0$ where $d$ is the exterior differential.</p>
<p>In otherwords, Ampere proved that the magnetic field $B$, Faraday's lines of force, were always generated by currents. But which currents? If we include image of classic magnet with the iron filings, then where is the current that is orientating the magnet, and what "current" corresponds to the iron filings?</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>How do we model a Birkeland current? [Include image]
We imagine a cylinder $D$ filled with plasma, and delivering a steady electrical current between the two ends of the cylinder. The question is: what is the charge distribution of a current-carrying plasma cylinder which has the minimal amount of internal <em>pressure</em>.</p>
<p>If $J$ represents the current density, then the equations of a Birkeland current with balanced internal forces satisfies $$0= \int_D d^3(y) ~ F_{J(y)~~\text{on}~~ J(x)}$$ for all $x\in D$.</p>
<p>Following Don Scott's approach, we look to express the above balanced equation in terms of cylindrical coordinates.</p>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/fp/2022/03/16/test_upload.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/fp/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/fp/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/fp/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Optimal Transport, Topology of Singularities, Physics.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>
